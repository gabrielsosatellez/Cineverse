{"ast":null,"code":"var _jsxFileName = \"C:\\\\WareHouse\\\\dam_2do\\\\proyecto\\\\Proyecto Final\\\\Cineverse_web\\\\cineverse-web\\\\src\\\\components\\\\common\\\\Sidebar.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Sidebar({\n  isOpen,\n  onSectionChange,\n  onLogout,\n  userRole\n}) {\n  _s();\n  const handleNavigation = section => {\n    onSectionChange(section);\n  };\n  const [deleting, setDeleting] = useState(false);\n  const handleDeleteAccount = async () => {\n    var _stored, _stored2, _stored3, _stored4, _stored5, _stored5$user, _stored6;\n    const ok = window.confirm(\"¿Estás seguro que quieres eliminar tu cuenta? Esta acción no se puede deshacer.\");\n    if (!ok) return;\n    setDeleting(true);\n    let stored = null;\n    try {\n      stored = JSON.parse(localStorage.getItem(\"currentUser\"));\n    } catch (e) {\n      stored = null;\n    }\n    const token = ((_stored = stored) === null || _stored === void 0 ? void 0 : _stored.token) || ((_stored2 = stored) === null || _stored2 === void 0 ? void 0 : _stored2.accessToken) || null;\n    const possibleId = ((_stored3 = stored) === null || _stored3 === void 0 ? void 0 : _stored3.id) || ((_stored4 = stored) === null || _stored4 === void 0 ? void 0 : _stored4._id) || ((_stored5 = stored) === null || _stored5 === void 0 ? void 0 : (_stored5$user = _stored5.user) === null || _stored5$user === void 0 ? void 0 : _stored5$user.id) || ((_stored6 = stored) === null || _stored6 === void 0 ? void 0 : _stored6.userId) || null;\n    const tryDelete = async (url, headers = {}) => {\n      try {\n        const res = await fetch(url, {\n          method: \"DELETE\",\n          headers\n        });\n        return res;\n      } catch (e) {\n        return null;\n      }\n    };\n    const base = \"http://localhost:8080/api/users\";\n    let res = null;\n\n    // Prefer deleting the current authenticated user via /me when token present\n    if (token) {\n      res = await tryDelete(`${base}/me`, {\n        Authorization: `Bearer ${token}`\n      });\n    }\n\n    // Fallback to deleting by id if available\n    if ((!res || !res.ok) && possibleId) {\n      res = await tryDelete(`${base}/${possibleId}`, token ? {\n        Authorization: `Bearer ${token}`\n      } : {});\n    }\n\n    // Final fallback: try deleting /api/users/me without token\n    if ((!res || !res.ok) && !token) {\n      res = await tryDelete(`${base}/me`, {});\n    }\n    if (res && res.ok) {\n      try {\n        alert(\"Cuenta eliminada correctamente\");\n      } catch (e) {}\n      try {\n        onLogout();\n      } catch (e) {}\n    } else {\n      try {\n        const body = res ? await res.json().catch(() => null) : null;\n        const msg = (body === null || body === void 0 ? void 0 : body.message) || \"Error al eliminar la cuenta\";\n        alert(msg);\n      } catch (e) {\n        alert(\"Error al eliminar la cuenta\");\n      }\n    }\n    setDeleting(false);\n  };\n  return isOpen && /*#__PURE__*/_jsxDEV(\"aside\", {\n    className: \"fixed top-0 left-0 h-full w-64 bg-gray-800 text-white p-4 z-50\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-xl font-bold mb-6\",\n      children: \"CineVerse\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-2 hover:bg-gray-700 cursor-pointer\",\n      onClick: () => handleNavigation(\"MOVIES\"),\n      children: \"Pel\\xEDculas\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-2 hover:bg-gray-700 cursor-pointer\",\n      onClick: () => handleNavigation(\"ROOMS\"),\n      children: \"Salas\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-2 hover:bg-gray-700 cursor-pointer\",\n      onClick: () => handleNavigation(\"SESSIONS\"),\n      children: \"Sesiones\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-2 hover:bg-gray-700 cursor-pointer\",\n      onClick: () => handleNavigation(\"TICKETS\"),\n      children: \"Entradas\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }, this), userRole === \"ADMIN\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-2 hover:bg-gray-700 cursor-pointer\",\n      onClick: () => handleNavigation(\"STARWARS\"),\n      children: \"Star Wars\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 11\n    }, this), userRole === \"ADMIN\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-2 hover:bg-gray-700 cursor-pointer\",\n      onClick: () => handleNavigation(\"USERS\"),\n      children: \"Gestionar usuarios\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 11\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-2 bg-red-600 hover:bg-red-700 mt-6 cursor-pointer transition-colors\",\n      onClick: onLogout,\n      children: \"Cerrar sesi\\xF3n\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `p-2 ${deleting ? 'bg-red-500' : 'bg-red-700 hover:bg-red-800'} mt-2 cursor-pointer transition-colors text-sm`,\n      onClick: deleting ? undefined : handleDeleteAccount,\n      role: \"button\",\n      \"aria-disabled\": deleting,\n      children: deleting ? 'Eliminando cuenta...' : 'Eliminar cuenta'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 7\n  }, this);\n}\n_s(Sidebar, \"f0tXCDL9Pnb+NA85nybi4v05dyY=\");\n_c = Sidebar;\nvar _c;\n$RefreshReg$(_c, \"Sidebar\");","map":{"version":3,"names":["React","useState","jsxDEV","_jsxDEV","Sidebar","isOpen","onSectionChange","onLogout","userRole","_s","handleNavigation","section","deleting","setDeleting","handleDeleteAccount","_stored","_stored2","_stored3","_stored4","_stored5","_stored5$user","_stored6","ok","window","confirm","stored","JSON","parse","localStorage","getItem","e","token","accessToken","possibleId","id","_id","user","userId","tryDelete","url","headers","res","fetch","method","base","Authorization","alert","body","json","catch","msg","message","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","undefined","role","_c","$RefreshReg$"],"sources":["C:/WareHouse/dam_2do/proyecto/Proyecto Final/Cineverse_web/cineverse-web/src/components/common/Sidebar.js"],"sourcesContent":["import React, { useState } from \"react\";\r\n\r\nexport default function Sidebar({ isOpen, onSectionChange, onLogout, userRole }) {\r\n  const handleNavigation = (section) => {\r\n    onSectionChange(section);\r\n  };\r\n\r\n  const [deleting, setDeleting] = useState(false);\r\n\r\n  const handleDeleteAccount = async () => {\r\n    const ok = window.confirm(\"¿Estás seguro que quieres eliminar tu cuenta? Esta acción no se puede deshacer.\");\r\n    if (!ok) return;\r\n    setDeleting(true);\r\n\r\n    let stored = null;\r\n    try { stored = JSON.parse(localStorage.getItem(\"currentUser\")); } catch (e) { stored = null; }\r\n    const token = stored?.token || stored?.accessToken || null;\r\n    const possibleId = stored?.id || stored?._id || stored?.user?.id || stored?.userId || null;\r\n\r\n    const tryDelete = async (url, headers = {}) => {\r\n      try {\r\n        const res = await fetch(url, { method: \"DELETE\", headers });\r\n        return res;\r\n      } catch (e) {\r\n        return null;\r\n      }\r\n    };\r\n\r\n    const base = \"http://localhost:8080/api/users\";\r\n    let res = null;\r\n\r\n    // Prefer deleting the current authenticated user via /me when token present\r\n    if (token) {\r\n      res = await tryDelete(`${base}/me`, { Authorization: `Bearer ${token}` });\r\n    }\r\n\r\n    // Fallback to deleting by id if available\r\n    if ((!res || !res.ok) && possibleId) {\r\n      res = await tryDelete(`${base}/${possibleId}`, token ? { Authorization: `Bearer ${token}` } : {});\r\n    }\r\n\r\n    // Final fallback: try deleting /api/users/me without token\r\n    if ((!res || !res.ok) && !token) {\r\n      res = await tryDelete(`${base}/me`, {});\r\n    }\r\n\r\n    if (res && res.ok) {\r\n      try { alert(\"Cuenta eliminada correctamente\"); } catch (e) {}\r\n      try { onLogout(); } catch (e) {}\r\n    } else {\r\n      try {\r\n        const body = res ? await res.json().catch(() => null) : null;\r\n        const msg = body?.message || \"Error al eliminar la cuenta\";\r\n        alert(msg);\r\n      } catch (e) {\r\n        alert(\"Error al eliminar la cuenta\");\r\n      }\r\n    }\r\n\r\n    setDeleting(false);\r\n  };\r\n\r\n  return (\r\n    isOpen && (\r\n      <aside className=\"fixed top-0 left-0 h-full w-64 bg-gray-800 text-white p-4 z-50\">\r\n        <h2 className=\"text-xl font-bold mb-6\">CineVerse</h2>\r\n\r\n        <div className=\"p-2 hover:bg-gray-700 cursor-pointer\"\r\n          onClick={() => handleNavigation(\"MOVIES\")}>\r\n          Películas\r\n        </div>\r\n\r\n        <div className=\"p-2 hover:bg-gray-700 cursor-pointer\"\r\n          onClick={() => handleNavigation(\"ROOMS\")}>\r\n          Salas\r\n        </div>\r\n\r\n        <div className=\"p-2 hover:bg-gray-700 cursor-pointer\"\r\n          onClick={() => handleNavigation(\"SESSIONS\")}>\r\n          Sesiones\r\n        </div>\r\n\r\n        <div className=\"p-2 hover:bg-gray-700 cursor-pointer\"\r\n          onClick={() => handleNavigation(\"TICKETS\")}>\r\n          Entradas\r\n        </div>\r\n\r\n        {userRole === \"ADMIN\" && (\r\n          <div className=\"p-2 hover:bg-gray-700 cursor-pointer\"\r\n            onClick={() => handleNavigation(\"STARWARS\")}>\r\n            Star Wars\r\n          </div>\r\n        )}\r\n\r\n        {userRole === \"ADMIN\" && (\r\n          <div className=\"p-2 hover:bg-gray-700 cursor-pointer\"\r\n            onClick={() => handleNavigation(\"USERS\")}>\r\n            Gestionar usuarios\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"p-2 bg-red-600 hover:bg-red-700 mt-6 cursor-pointer transition-colors\"\r\n          onClick={onLogout}>\r\n          Cerrar sesión\r\n        </div>\r\n        <div\r\n          className={`p-2 ${deleting ? 'bg-red-500' : 'bg-red-700 hover:bg-red-800'} mt-2 cursor-pointer transition-colors text-sm`}\r\n          onClick={deleting ? undefined : handleDeleteAccount}\r\n          role=\"button\"\r\n          aria-disabled={deleting}\r\n        >\r\n          {deleting ? 'Eliminando cuenta...' : 'Eliminar cuenta'}\r\n        </div>\r\n      </aside>\r\n    )\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}