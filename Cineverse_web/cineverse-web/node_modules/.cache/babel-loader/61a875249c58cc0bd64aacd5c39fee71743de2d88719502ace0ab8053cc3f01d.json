{"ast":null,"code":"var _jsxFileName = \"C:\\\\WareHouse\\\\dam_2do\\\\proyecto\\\\Proyecto Final\\\\Cineverse_web\\\\cineverse-web\\\\src\\\\components\\\\tickets\\\\TicketsSection.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { formatDateTime, fetchData } from \"../../utils/api\";\nimport SeatGrid from \"./SeatGrid\";\nimport SeatModal from \"./SeatModal\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function TicketsSection({\n  sessions,\n  selectedSession,\n  setSelectedSession,\n  takenSeats,\n  setTakenSeats\n}) {\n  _s();\n  const [showSeatModal, setShowSeatModal] = useState(false);\n  const [selectedSeat, setSelectedSeat] = useState(null);\n  const [seatInfo, setSeatInfo] = useState(\"\");\n  const [newSeat, setNewSeat] = useState(\"\");\n  useEffect(() => {\n    if (!selectedSession) return;\n    const interval = setInterval(() => {\n      fetchData(`http://localhost:8080/api/tickets/session/${selectedSession.id}`).then(data => setTakenSeats(data.map(t => t.seatNumber))).catch(err => console.error(err));\n    }, 3000);\n    return () => clearInterval(interval);\n  }, [selectedSession, setTakenSeats]);\n  const handleSeatClick = async seatNumber => {\n    try {\n      const response = await fetch(`http://localhost:8080/api/tickets/session/${selectedSession.id}/seat/${seatNumber}`);\n      const data = response.ok ? await response.json() : {\n        occupied: false\n      };\n      if (data.occupied) {\n        setSeatInfo(`Asiento ${seatNumber} ocupado por ${data.username}`);\n      } else {\n        setSeatInfo(`Asiento ${seatNumber} disponible`);\n      }\n      setSelectedSeat(seatNumber);\n      setShowSeatModal(true);\n    } catch (err) {\n      console.error(err);\n    }\n  };\n  const refreshSeats = async () => {\n    if (!selectedSession) return;\n    const data = await fetchData(`http://localhost:8080/api/tickets/session/${selectedSession.id}`);\n    setTakenSeats(data.map(t => t.seatNumber));\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-2xl font-bold mb-4\",\n      children: \"Gestionar entradas\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n      className: \"border p-2 mb-4\",\n      required: true,\n      value: (selectedSession === null || selectedSession === void 0 ? void 0 : selectedSession.id) || \"\",\n      onChange: e => {\n        const session = sessions.find(s => s.id === Number(e.target.value));\n        if (!session) return;\n        setSelectedSession(session);\n        fetchData(`http://localhost:8080/api/tickets/session/${session.id}`).then(data => setTakenSeats(data.map(t => t.seatNumber)));\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"option\", {\n        value: \"\",\n        disabled: true,\n        children: \"Selecciona sesi\\xF3n\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this), [...sessions].sort((a, b) => new Date(a.dateTime) - new Date(b.dateTime)).map(s => /*#__PURE__*/_jsxDEV(\"option\", {\n        value: s.id,\n        children: [s.movie.title, \" \\u2014 \", s.room.name, \" \\u2014 \", formatDateTime(s.dateTime)]\n      }, s.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 13\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }, this), selectedSession && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-5xl mx-auto mt-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center mb-3 text-lg font-semibold flex justify-center items-center gap-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: [selectedSession.room.name, \" \\xB7 \", selectedSession.room.totalSeats, \" asientos\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-red-600\",\n          children: [\"Ocupados: \", takenSeats.length]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-green-600\",\n          children: [\"Libres: \", selectedSession.room.totalSeats - takenSeats.length]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-gray-300 text-center py-1 mb-5 rounded font-bold w-2/3 mx-auto\",\n        children: \"PANTALLA\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(SeatGrid, {\n        selectedSession: selectedSession,\n        takenSeats: takenSeats,\n        onSeatClick: handleSeatClick\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(SeatModal, {\n      isOpen: showSeatModal,\n      seatInfo: seatInfo,\n      selectedSeat: selectedSeat,\n      selectedSession: selectedSession,\n      takenSeats: takenSeats,\n      setTakenSeats: setTakenSeats,\n      newSeat: newSeat,\n      setNewSeat: setNewSeat,\n      onClose: () => {\n        setShowSeatModal(false);\n        setSelectedSeat(null);\n        setSeatInfo(\"\");\n        setNewSeat(\"\");\n      },\n      onRefresh: refreshSeats\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s(TicketsSection, \"DvImY7rqORDwhdDqooi5gBYJoTY=\");\n_c = TicketsSection;\nvar _c;\n$RefreshReg$(_c, \"TicketsSection\");","map":{"version":3,"names":["React","useState","useEffect","formatDateTime","fetchData","SeatGrid","SeatModal","jsxDEV","_jsxDEV","Fragment","_Fragment","TicketsSection","sessions","selectedSession","setSelectedSession","takenSeats","setTakenSeats","_s","showSeatModal","setShowSeatModal","selectedSeat","setSelectedSeat","seatInfo","setSeatInfo","newSeat","setNewSeat","interval","setInterval","id","then","data","map","t","seatNumber","catch","err","console","error","clearInterval","handleSeatClick","response","fetch","ok","json","occupied","username","refreshSeats","children","className","fileName","_jsxFileName","lineNumber","columnNumber","required","value","onChange","e","session","find","s","Number","target","disabled","sort","a","b","Date","dateTime","movie","title","room","name","totalSeats","length","onSeatClick","isOpen","onClose","onRefresh","_c","$RefreshReg$"],"sources":["C:/WareHouse/dam_2do/proyecto/Proyecto Final/Cineverse_web/cineverse-web/src/components/tickets/TicketsSection.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { formatDateTime, fetchData } from \"../../utils/api\";\r\nimport SeatGrid from \"./SeatGrid\";\r\nimport SeatModal from \"./SeatModal\";\r\n\r\nexport default function TicketsSection({ sessions, selectedSession, setSelectedSession, takenSeats, setTakenSeats }) {\r\n  const [showSeatModal, setShowSeatModal] = useState(false);\r\n  const [selectedSeat, setSelectedSeat] = useState(null);\r\n  const [seatInfo, setSeatInfo] = useState(\"\");\r\n  const [newSeat, setNewSeat] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    if (!selectedSession) return;\r\n\r\n    const interval = setInterval(() => {\r\n      fetchData(`http://localhost:8080/api/tickets/session/${selectedSession.id}`)\r\n        .then(data => setTakenSeats(data.map(t => t.seatNumber)))\r\n        .catch(err => console.error(err));\r\n    }, 3000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [selectedSession, setTakenSeats]);\r\n\r\n  const handleSeatClick = async (seatNumber) => {\r\n    try {\r\n      const response = await fetch(\r\n        `http://localhost:8080/api/tickets/session/${selectedSession.id}/seat/${seatNumber}`\r\n      );\r\n      const data = response.ok ? await response.json() : { occupied: false };\r\n\r\n      if (data.occupied) {\r\n        setSeatInfo(`Asiento ${seatNumber} ocupado por ${data.username}`);\r\n      } else {\r\n        setSeatInfo(`Asiento ${seatNumber} disponible`);\r\n      }\r\n      setSelectedSeat(seatNumber);\r\n      setShowSeatModal(true);\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  const refreshSeats = async () => {\r\n    if (!selectedSession) return;\r\n    const data = await fetchData(`http://localhost:8080/api/tickets/session/${selectedSession.id}`);\r\n    setTakenSeats(data.map(t => t.seatNumber));\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <h2 className=\"text-2xl font-bold mb-4\">Gestionar entradas</h2>\r\n\r\n      <select\r\n        className=\"border p-2 mb-4\"\r\n        required\r\n        value={selectedSession?.id || \"\"}\r\n        onChange={e => {\r\n          const session = sessions.find(s => s.id === Number(e.target.value));\r\n          if (!session) return;\r\n\r\n          setSelectedSession(session);\r\n          fetchData(`http://localhost:8080/api/tickets/session/${session.id}`)\r\n            .then(data => setTakenSeats(data.map(t => t.seatNumber)));\r\n        }}\r\n      >\r\n        <option value=\"\" disabled>Selecciona sesión</option>\r\n        {[...sessions]\r\n          .sort((a, b) => new Date(a.dateTime) - new Date(b.dateTime))\r\n          .map(s => (\r\n            <option key={s.id} value={s.id}>\r\n              {s.movie.title} — {s.room.name} — {formatDateTime(s.dateTime)}\r\n            </option>\r\n          ))}\r\n      </select>\r\n\r\n      {selectedSession && (\r\n        <div className=\"max-w-5xl mx-auto mt-4\">\r\n          {/* INFO SALA */}\r\n          <div className=\"text-center mb-3 text-lg font-semibold flex justify-center items-center gap-6\">\r\n            <span>\r\n              {selectedSession.room.name} · {selectedSession.room.totalSeats} asientos\r\n            </span>\r\n            <span className=\"text-red-600\">\r\n              Ocupados: {takenSeats.length}\r\n            </span>\r\n            <span className=\"text-green-600\">\r\n              Libres: {selectedSession.room.totalSeats - takenSeats.length}\r\n            </span>\r\n          </div>\r\n\r\n          {/* PANTALLA */}\r\n          <div className=\"bg-gray-300 text-center py-1 mb-5 rounded font-bold w-2/3 mx-auto\">\r\n            PANTALLA\r\n          </div>\r\n\r\n          {/* SALA */}\r\n          <SeatGrid\r\n            selectedSession={selectedSession}\r\n            takenSeats={takenSeats}\r\n            onSeatClick={handleSeatClick}\r\n          />\r\n        </div>\r\n      )}\r\n\r\n      {/* MODAL ASIENTOS */}\r\n      <SeatModal\r\n        isOpen={showSeatModal}\r\n        seatInfo={seatInfo}\r\n        selectedSeat={selectedSeat}\r\n        selectedSession={selectedSession}\r\n        takenSeats={takenSeats}\r\n        setTakenSeats={setTakenSeats}\r\n        newSeat={newSeat}\r\n        setNewSeat={setNewSeat}\r\n        onClose={() => {\r\n          setShowSeatModal(false);\r\n          setSelectedSeat(null);\r\n          setSeatInfo(\"\");\r\n          setNewSeat(\"\");\r\n        }}\r\n        onRefresh={refreshSeats}\r\n      />\r\n    </>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}