{"ast":null,"code":"import React,{useState}from\"react\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Sidebar(_ref){let{isOpen,onSectionChange,onLogout,userRole}=_ref;// Gestiona el cambio de sección en el panel principal\nconst handleNavigation=section=>{onSectionChange(section);};const[deleting,setDeleting]=useState(false);const[confirmOpen,setConfirmOpen]=useState(false);// Abre el modal de confirmación para eliminar la cuenta\nconst handleDeleteAccount=()=>{setConfirmOpen(true);};// Ejecuta la eliminación de la cuenta del usuario autenticado\nconst handleConfirmDelete=async()=>{var _user;setDeleting(true);setConfirmOpen(false);let user=null;try{user=JSON.parse(localStorage.getItem(\"currentUser\"));}catch(e){user=null;}// Validación básica del usuario antes de realizar la petición\nif(!((_user=user)!==null&&_user!==void 0&&_user.id)){alert(\"No se pudo identificar al usuario\");setDeleting(false);return;}try{var _user2;const headers={};if((_user2=user)!==null&&_user2!==void 0&&_user2.token){headers[\"Authorization\"]=\"Bearer \".concat(user.token);}// Petición al backend para eliminar la cuenta del usuario\nconst res=await fetch(\"http://localhost:8080/api/users/\".concat(user.id),{method:\"DELETE\",headers});if(!res.ok){const errorBody=await res.json().catch(()=>({}));throw new Error(errorBody.message||\"Error al eliminar la cuenta\");}alert(\"Cuenta eliminada correctamente\");onLogout();}catch(e){alert(e.message||\"Error al eliminar la cuenta\");}finally{setDeleting(false);}};return isOpen&&/*#__PURE__*/_jsxs(\"aside\",{className:\"fixed top-0 left-0 h-full w-64 bg-gray-800 text-white p-4 z-50\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-6\",children:\"CineVerse\"}),/*#__PURE__*/_jsx(\"div\",{className:\"p-2 hover:bg-gray-700 cursor-pointer\",onClick:()=>handleNavigation(\"MOVIES\"),children:\"Pel\\xEDculas\"}),/*#__PURE__*/_jsx(\"div\",{className:\"p-2 hover:bg-gray-700 cursor-pointer\",onClick:()=>handleNavigation(\"ROOMS\"),children:\"Salas\"}),/*#__PURE__*/_jsx(\"div\",{className:\"p-2 hover:bg-gray-700 cursor-pointer\",onClick:()=>handleNavigation(\"SESSIONS\"),children:\"Sesiones\"}),/*#__PURE__*/_jsx(\"div\",{className:\"p-2 hover:bg-gray-700 cursor-pointer\",onClick:()=>handleNavigation(\"TICKETS\"),children:\"Entradas\"}),userRole!==\"USER\"&&/*#__PURE__*/_jsx(\"div\",{className:\"p-2 hover:bg-gray-700 cursor-pointer\",onClick:()=>handleNavigation(\"STARWARS\"),children:\"Star Wars\"}),userRole===\"ADMIN\"&&/*#__PURE__*/_jsx(\"div\",{className:\"p-2 hover:bg-gray-700 cursor-pointer\",onClick:()=>handleNavigation(\"USERS\"),children:\"Gestionar usuarios\"}),/*#__PURE__*/_jsx(\"div\",{className:\"p-2 bg-red-600 hover:bg-red-700 mt-6 cursor-pointer transition-colors\",onClick:onLogout,children:\"Cerrar sesi\\xF3n\"}),/*#__PURE__*/_jsx(\"div\",{className:\"p-2 bg-red-600 hover:bg-red-700 mt-2 cursor-pointer transition-colors\",onClick:handleDeleteAccount,children:\"Eliminar cuenta\"}),confirmOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg p-6 w-96 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold mb-2 text-gray-900\",children:\"Confirmar eliminaci\\xF3n\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-4 text-gray-700\",children:\"\\xBFEst\\xE1s seguro que quieres eliminar tu cuenta? Esta acci\\xF3n no se puede deshacer.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded w-full\",onClick:()=>setConfirmOpen(false),children:\"Cancelar\"}),/*#__PURE__*/_jsx(\"button\",{className:\"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded w-full\",onClick:handleConfirmDelete,children:\"Eliminar\"})]})]})})]});}","map":{"version":3,"names":["React","useState","jsx","_jsx","jsxs","_jsxs","Sidebar","_ref","isOpen","onSectionChange","onLogout","userRole","handleNavigation","section","deleting","setDeleting","confirmOpen","setConfirmOpen","handleDeleteAccount","handleConfirmDelete","_user","user","JSON","parse","localStorage","getItem","e","id","alert","_user2","headers","token","concat","res","fetch","method","ok","errorBody","json","catch","Error","message","className","children","onClick"],"sources":["C:/WareHouse/school/dam_2do/proyecto/Proyecto Final/Cineverse_web/cineverse-web/src/components/common/Sidebar.js"],"sourcesContent":["import React, { useState } from \"react\";\r\n\r\nexport default function Sidebar({ isOpen, onSectionChange, onLogout, userRole }) {\r\n\r\n    // Gestiona el cambio de sección en el panel principal\r\n    const handleNavigation = (section) => {\r\n        onSectionChange(section);\r\n    };\r\n\r\n    const [deleting, setDeleting] = useState(false);\r\n    const [confirmOpen, setConfirmOpen] = useState(false);\r\n\r\n    // Abre el modal de confirmación para eliminar la cuenta\r\n    const handleDeleteAccount = () => {\r\n        setConfirmOpen(true);\r\n    };\r\n\r\n    // Ejecuta la eliminación de la cuenta del usuario autenticado\r\n    const handleConfirmDelete = async () => {\r\n        setDeleting(true);\r\n        setConfirmOpen(false);\r\n\r\n        let user = null;\r\n        try {\r\n            user = JSON.parse(localStorage.getItem(\"currentUser\"));\r\n        } catch (e) {\r\n            user = null;\r\n        }\r\n\r\n        // Validación básica del usuario antes de realizar la petición\r\n        if (!user?.id) {\r\n            alert(\"No se pudo identificar al usuario\");\r\n            setDeleting(false);\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const headers = {};\r\n            if (user?.token) {\r\n                headers[\"Authorization\"] = `Bearer ${user.token}`;\r\n            }\r\n\r\n            // Petición al backend para eliminar la cuenta del usuario\r\n            const res = await fetch(`http://localhost:8080/api/users/${user.id}`, {\r\n                method: \"DELETE\",\r\n                headers\r\n            });\r\n\r\n            if (!res.ok) {\r\n                const errorBody = await res.json().catch(() => ({}));\r\n                throw new Error(errorBody.message || \"Error al eliminar la cuenta\");\r\n            }\r\n\r\n            alert(\"Cuenta eliminada correctamente\");\r\n            onLogout();\r\n        } catch (e) {\r\n            alert(e.message || \"Error al eliminar la cuenta\");\r\n        } finally {\r\n            setDeleting(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        isOpen && (\r\n            <aside className=\"fixed top-0 left-0 h-full w-64 bg-gray-800 text-white p-4 z-50\">\r\n                <h2 className=\"text-xl font-bold mb-6\">CineVerse</h2>\r\n\r\n                <div\r\n                    className=\"p-2 hover:bg-gray-700 cursor-pointer\"\r\n                    onClick={() => handleNavigation(\"MOVIES\")}\r\n                >\r\n                    Películas\r\n                </div>\r\n\r\n                <div\r\n                    className=\"p-2 hover:bg-gray-700 cursor-pointer\"\r\n                    onClick={() => handleNavigation(\"ROOMS\")}\r\n                >\r\n                    Salas\r\n                </div>\r\n\r\n                <div\r\n                    className=\"p-2 hover:bg-gray-700 cursor-pointer\"\r\n                    onClick={() => handleNavigation(\"SESSIONS\")}\r\n                >\r\n                    Sesiones\r\n                </div>\r\n\r\n                <div\r\n                    className=\"p-2 hover:bg-gray-700 cursor-pointer\"\r\n                    onClick={() => handleNavigation(\"TICKETS\")}\r\n                >\r\n                    Entradas\r\n                </div>\r\n\r\n                {/* Secciones visibles solo para empleados y administradores */}\r\n                {userRole !== \"USER\" && (\r\n                    <div\r\n                        className=\"p-2 hover:bg-gray-700 cursor-pointer\"\r\n                        onClick={() => handleNavigation(\"STARWARS\")}\r\n                    >\r\n                        Star Wars\r\n                    </div>\r\n                )}\r\n\r\n                {/* Sección visible solo para administradores */}\r\n                {userRole === \"ADMIN\" && (\r\n                    <div\r\n                        className=\"p-2 hover:bg-gray-700 cursor-pointer\"\r\n                        onClick={() => handleNavigation(\"USERS\")}\r\n                    >\r\n                        Gestionar usuarios\r\n                    </div>\r\n                )}\r\n\r\n                {/* Acción de cierre de sesión */}\r\n                <div\r\n                    className=\"p-2 bg-red-600 hover:bg-red-700 mt-6 cursor-pointer transition-colors\"\r\n                    onClick={onLogout}\r\n                >\r\n                    Cerrar sesión\r\n                </div>\r\n\r\n                {/* Acción de eliminación de cuenta */}\r\n                <div\r\n                    className=\"p-2 bg-red-600 hover:bg-red-700 mt-2 cursor-pointer transition-colors\"\r\n                    onClick={handleDeleteAccount}\r\n                >\r\n                    Eliminar cuenta\r\n                </div>\r\n\r\n                {/* Modal de confirmación para eliminar la cuenta */}\r\n                {confirmOpen && (\r\n                    <div className=\"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50\">\r\n                        <div className=\"bg-white rounded-lg p-6 w-96 shadow-lg\">\r\n                            <h3 className=\"text-lg font-bold mb-2 text-gray-900\">\r\n                                Confirmar eliminación\r\n                            </h3>\r\n                            <p className=\"mb-4 text-gray-700\">\r\n                                ¿Estás seguro que quieres eliminar tu cuenta? Esta acción no se puede deshacer.\r\n                            </p>\r\n                            <div className=\"flex gap-3\">\r\n                                <button\r\n                                    className=\"bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded w-full\"\r\n                                    onClick={() => setConfirmOpen(false)}\r\n                                >\r\n                                    Cancelar\r\n                                </button>\r\n                                <button\r\n                                    className=\"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded w-full\"\r\n                                    onClick={handleConfirmDelete}\r\n                                >\r\n                                    Eliminar\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </aside>\r\n        )\r\n    );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}